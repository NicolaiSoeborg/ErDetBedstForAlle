<!DOCTYPE html>
<html manifest="bedstforalle.appcache">
<head>
  <title>Er det bedst for alle?</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="Nicolai Søborg">
  <meta http-equiv="pragma" content="NO-CACHE">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" sizes="192x192" href="icon-192x192.png">
  <link rel="apple-touch-icon" sizes="128x128" href="icon-128x128.png">
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>  
</head>
<body style="background-image:url(bg.jpg); background-repeat:no-repeat; background-size:cover;">
    <div id="content">
        <h1 id="Ja"  class="box hidden showElement"> JA </h1>
        <h1 id="Nej" class="box hidden showElement"> NEJ </h1>
        <h1 id="Spg" class="Spg box showElement">Er det bedst for alle?</h1>
    </div>
	<footer class="Spg hidden showElement"><a href="http://xn--erklderbarenben-slbh.dk/" style="color:blue;">Kælderbaren er åben!</a></footer>
    <div class="overlayer"></div>
<script>
var extra = 0.0;

$.ajax({
  method: "GET",
  url: "ajax.php?r=" + Math.random(),
  dataType: "text",
  success: function(data) {
    if (data !== "No") {
      console.log("Det er bedst for alle!");
      extra = 0.1;
      $("footer").removeClass("hidden");
    }
  },
  error: function (data) {
    console.log(data);
  }
});

var bedstforalle = function() {
  return Math.random() + extra >= 0.5;
}

var duration = 100; // very fast

$( ".Spg" ).click(function() {
  $( "#Spg" ).animate({opacity: 0}, duration, function(){
    $(this).addClass("hidden"); // #Spg
    $( bedstforalle() ? "#Ja" : "#Nej" ).animate({opacity: 1}, duration, function() {
      $(this).removeClass("hidden") // #Ja || #Nej
    })
  })
});

$( ".introjs-overlay, .hidden" ).click(function() {
  $( "#Ja, #Nej" ).each(function() {
    $(this).animate({opacity: 0}, duration/2, function(){
      $(this).addClass("hidden"); // #Ja || #Nej
      $( "#Spg" ).animate({opacity: 1}, duration/2, function() {
        $(this).removeClass("hidden") // #Spg
      })
    })
  })
});
</script>
</body>
</html>
